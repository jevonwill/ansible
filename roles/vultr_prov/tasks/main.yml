# ansible-playbook deploy.yml -i group_vars/vultr.yml

-

        block:

          - name: Ensure VM exists
            local_action:
              module: vultr_server
              name: "{{ hostname }}"
              os: "{{ image }}"
              plan: "{{ plan }}"
              region: "{{ region }}"


          - name: Copy ssh key
            local_action: 
              module: vultr_ssh_key
              name: "{{ user }}"
              ssh_key: "{{ lookup('file', '~/.ssh/authorized_keys') }}"


          - name: Create firewallgroup
            local_action: 
              module: vultr_firewall_group
              name: "{{ firewall_group }}"

          - name: "Get public IP of ansible host"
            local_action:
              module: ipify_facts
             


